service: Self-Help-Service-Portal-backend

provider:
  name: aws
  runtime: nodejs20.x
  profile: ${self:custom.profiles.${opt:stage, 'sandbox2'}}
  region: us-east-1
  environment:
    NODE_ENV: production
    COGNITO_USER_POOL_ID: us-east-1_4MUwDBUrm
    COGNITO_CLIENT_ID: 3iclk3cb58p485ah2iasfb3pha
    DYNAMODB_USERS_TABLE: users

  iamRoleStatements:
    - Effect: Allow
      Action:
        - cognito-idp:AdminCreateUser
        - cognito-idp:AdminSetUserPassword
        - cognito-idp:AdminInitiateAuth
        - cognito-idp:AdminGetUser
      Resource: "arn:aws:cognito-idp:us-east-1:572163714811:userpool/us-east-1_4MUwDBUrm"

    - Effect: Allow
      Action:
        - dynamodb:PutItem
        - dynamodb:GetItem
        - dynamodb:UpdateItem
        - dynamodb:Scan
        - dynamodb:Query
      Resource: "arn:aws:dynamodb:us-east-1:572163714811:table/users"

custom:
  profiles:
    sandbox: AdministratorAccess-061051226351
    sandbox2: AdministratorAccess-2-572163714811

functions:
  app:
    handler: dist/app.handler
    events:
      - http:
          path: /auth/admin/register
          method: post
      - http:
          path: /auth/admin/login
          method: post
      - http:
          path: /auth/admin/logout
          method: post
      - http:
          path: /auth/employee/login
          method: post
      - http:
          path: /auth/employee/logout
          method: post
      - http:
          path: /auth/admin/create-employee
          method: post
